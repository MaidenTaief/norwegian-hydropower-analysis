{
  "dashboard": {
    "id": null,
    "title": "üá≥üá¥ Norwegian Dam Health Monitoring",
    "tags": ["norway", "dams", "monitoring", "hydropower"],
    "timezone": "Europe/Oslo",
    "panels": [
      {
        "id": 1,
        "title": "üìä Total Norwegian Dams",
        "type": "stat",
        "targets": [
          {
            "expr": "SELECT COUNT(*) FROM dams WHERE status = 'active'",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "steps": [
                {"color": "green", "value": null},
                {"color": "yellow", "value": 1000},
                {"color": "red", "value": 5000}
              ]
            }
          }
        },
        "gridPos": {"h": 8, "w": 6, "x": 0, "y": 0}
      },
      {
        "id": 2,
        "title": "‚ö†Ô∏è High Risk Dams",
        "type": "stat",
        "targets": [
          {
            "expr": "SELECT COUNT(*) FROM dams WHERE risk_level = 'high' AND status = 'active'",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "steps": [
                {"color": "green", "value": null},
                {"color": "yellow", "value": 5},
                {"color": "red", "value": 10}
              ]
            }
          }
        },
        "gridPos": {"h": 8, "w": 6, "x": 6, "y": 0}
      },
      {
        "id": 3,
        "title": "üö® Active Alerts",
        "type": "stat",
        "targets": [
          {
            "expr": "SELECT COUNT(*) FROM alerts WHERE status = 'active'",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "steps": [
                {"color": "green", "value": null},
                {"color": "yellow", "value": 1},
                {"color": "red", "value": 5}
              ]
            }
          }
        },
        "gridPos": {"h": 8, "w": 6, "x": 12, "y": 0}
      },
      {
        "id": 4,
        "title": "üíß Average Health Score",
        "type": "stat",
        "targets": [
          {
            "expr": "SELECT ROUND(AVG(overall_score), 1) FROM latest_dam_health WHERE overall_score IS NOT NULL",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "steps": [
                {"color": "red", "value": null},
                {"color": "yellow", "value": 60},
                {"color": "green", "value": 80}
              ]
            }
          }
        },
        "gridPos": {"h": 8, "w": 6, "x": 18, "y": 0}
      },
      {
        "id": 5,
        "title": "üéØ Risk Distribution by County",
        "type": "piechart",
        "targets": [
          {
            "expr": "SELECT county, COUNT(*) as dam_count FROM dams WHERE county IS NOT NULL GROUP BY county ORDER BY dam_count DESC",
            "refId": "A"
          }
        ],
        "gridPos": {"h": 10, "w": 12, "x": 0, "y": 8}
      },
      {
        "id": 6,
        "title": "üìà Health Scores Over Time",
        "type": "timeseries",
        "targets": [
          {
            "expr": "SELECT time, dam_id, overall_score FROM health_scores WHERE time > NOW() - INTERVAL '7 days' ORDER BY time",
            "refId": "A"
          }
        ],
        "gridPos": {"h": 10, "w": 12, "x": 12, "y": 8}
      },
      {
        "id": 7,
        "title": "üå°Ô∏è Norwegian Weather Data",
        "type": "timeseries",
        "targets": [
          {
            "expr": "SELECT time, temperature_c, precipitation_mm FROM weather_data WHERE time > NOW() - INTERVAL '24 hours' ORDER BY time",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "axisLabel": "Temperature (¬∞C) / Precipitation (mm)"
            }
          }
        },
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 18}
      },
      {
        "id": 8,
        "title": "üíß Water Levels",
        "type": "timeseries",
        "targets": [
          {
            "expr": "SELECT time, water_level_m, reservoir_fill_percent FROM water_levels WHERE time > NOW() - INTERVAL '24 hours' ORDER BY time",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "axisLabel": "Water Level (m) / Fill (%)"
            }
          }
        },
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 18}
      },
      {
        "id": 9,
        "title": "üó∫Ô∏è Norwegian Dams by Municipality",
        "type": "table",
        "targets": [
          {
            "expr": "SELECT municipality, county, COUNT(*) as dam_count, AVG(lh.overall_score) as avg_health FROM dams d LEFT JOIN latest_dam_health lh ON d.dam_id = lh.dam_id WHERE d.municipality IS NOT NULL GROUP BY municipality, county ORDER BY dam_count DESC LIMIT 20",
            "refId": "A"
          }
        ],
        "gridPos": {"h": 10, "w": 24, "x": 0, "y": 26}
      },
      {
        "id": 10,
        "title": "üö® Recent Alerts",
        "type": "logs",
        "targets": [
          {
            "expr": "SELECT created_at, title, severity, description FROM alerts ORDER BY created_at DESC LIMIT 50",
            "refId": "A"
          }
        ],
        "gridPos": {"h": 8, "w": 24, "x": 0, "y": 36}
      }
    ],
    "time": {
      "from": "now-24h",
      "to": "now"
    },
    "timepicker": {},
    "templating": {
      "list": [
        {
          "name": "county",
          "type": "query",
          "query": "SELECT DISTINCT county FROM dams WHERE county IS NOT NULL ORDER BY county",
          "includeAll": true,
          "allValue": null
        }
      ]
    },
    "annotations": {
      "list": [
        {
          "name": "Dam Alerts",
          "datasource": "PostgreSQL",
          "enable": true,
          "query": "SELECT created_at as time, title as text, 'alert' as tags FROM alerts WHERE status = 'active'"
        }
      ]
    },
    "refresh": "5m",
    "version": 1
  },
  "meta": {
    "type": "db",
    "canSave": true,
    "canEdit": true,
    "canAdmin": true,
    "canStar": true,
    "slug": "norwegian-dam-health-monitoring",
    "url": "/d/norwegian-dams/norwegian-dam-health-monitoring",
    "expires": "0001-01-01T00:00:00Z",
    "created": "2025-08-05T22:00:00Z",
    "updated": "2025-08-05T22:00:00Z",
    "updatedBy": "admin",
    "createdBy": "admin",
    "version": 1,
    "hasAcl": false,
    "isFolder": false,
    "folderId": 0,
    "folderTitle": "General",
    "folderUrl": "",
    "provisioned": false,
    "provisionedExternalId": ""
  }
} 